# ===============================================
# BASIC TMUX CONFIGURATION
# ===============================================

# Set prefix key to Ctrl+g
set -g prefix C-g
unbind C-b
bind C-g send-prefix

# Enable mouse support
set -g mouse on

# Start windows and panes at 1, not 0
set -g base-index 1
set -g pane-base-index 1

# No escape time delay
set -sg escape-time 0

# Vi mode
set -g mode-keys vi
set-window-option -g mode-keys vi

# Terminal settings
set -g default-terminal "tmux-256color"

# True color support
set -ga terminal-overrides ",xterm-256color*:Tc"
set -as terminal-features ",xterm-256color:RGB"

# Enable image passthrough (critical for neovim image support)
set -gq allow-passthrough on
set -g visual-activity off

# History limit
set -g history-limit 10000

# Renumber windows when one is closed
set -g renumber-windows on

# Monitor activity but don't show notifications
setw -g monitor-activity on
set -g visual-activity off

# ===============================================
# KEY BINDINGS
# ===============================================

# Better copy mode
bind-key -T copy-mode-vi v send-keys -X begin-selection
bind-key -T copy-mode-vi C-v send-keys -X rectangle-toggle
bind-key -T copy-mode-vi y send-keys -X copy-selection-and-cancel

# Pane navigation (vim-like)
bind h select-pane -L
bind j select-pane -D
bind k select-pane -U
bind l select-pane -R

# Window navigation
bind -n M-H previous-window
bind -n M-L next-window

# Pane splitting with better keys
bind | split-window -h -c "#{pane_current_path}"
bind - split-window -v -c "#{pane_current_path}"
unbind '"'
unbind %

# New window in current path
bind c new-window -c "#{pane_current_path}"

# Quick pane cycling
bind -r Tab select-pane -t :.+

# Reload config
bind r source-file ~/.config/tmux/tmux.conf

# Clear screen and history
bind C-l send-keys 'C-l'

# ===============================================
# ZELLIJ-STYLE CHORD KEYBINDINGS
# ===============================================
# After pressing Ctrl+g, you can press single letters without holding Ctrl

# Tab/Window management mode (Ctrl+g, then t)
bind t switch-client -T tab_mode
bind -T tab_mode n new-window -c "#{pane_current_path}"
bind -T tab_mode c new-window -c "#{pane_current_path}"  
bind -T tab_mode x confirm-before -p "kill-window #W? (y/n)" kill-window
bind -T tab_mode r command-prompt "rename-window %%"
bind -T tab_mode h previous-window
bind -T tab_mode l next-window
bind -T tab_mode 1 select-window -t 1
bind -T tab_mode 2 select-window -t 2
bind -T tab_mode 3 select-window -t 3
bind -T tab_mode 4 select-window -t 4
bind -T tab_mode 5 select-window -t 5
bind -T tab_mode 6 select-window -t 6
bind -T tab_mode 7 select-window -t 7
bind -T tab_mode 8 select-window -t 8
bind -T tab_mode 9 select-window -t 9
bind -T tab_mode 0 select-window -t 10
bind -T tab_mode Tab last-window
bind -T tab_mode Escape switch-client -T root

# Pane management mode (Ctrl+g, then p)  
bind p switch-client -T pane_mode
bind -T pane_mode n split-window -h -c "#{pane_current_path}"
bind -T pane_mode d split-window -v -c "#{pane_current_path}"
bind -T pane_mode x confirm-before -p "kill-pane? (y/n)" kill-pane
bind -T pane_mode f resize-pane -Z
bind -T pane_mode h select-pane -L
bind -T pane_mode j select-pane -D  
bind -T pane_mode k select-pane -U
bind -T pane_mode l select-pane -R
bind -T pane_mode Tab select-pane -t :.+
bind -T pane_mode w display-panes
bind -T pane_mode Escape switch-client -T root

# Session management mode (Ctrl+g, then s)
bind s switch-client -T session_mode  
bind -T session_mode n command-prompt "new-session -s %%"
bind -T session_mode r command-prompt "rename-session %%"
bind -T session_mode l choose-session
bind -T session_mode d detach-client
bind -T session_mode x confirm-before -p "kill-session #S? (y/n)" kill-session
bind -T session_mode Escape switch-client -T root

# Quick actions (single key after Ctrl+g)
bind q display-panes
bind w choose-window
bind e choose-session  
bind / copy-mode \; send-keys ?

# Keep some original bindings for compatibility
bind | split-window -h -c "#{pane_current_path}"
bind - split-window -v -c "#{pane_current_path}"
bind c new-window -c "#{pane_current_path}"

# ===============================================
# KANAGAWA BONES THEME (matching your work setup)
# ===============================================

# Colors based on Kanagawa Bones theme
# Primary colors from your kitty config
COLOR_BG="#1F1F28"
COLOR_FG="#DDD8BB"
COLOR_ACCENT="#7EB3C9"
COLOR_HIGHLIGHT="#E5C283"
COLOR_PURPLE="#957FB8"
COLOR_GREEN="#98BC6D"
COLOR_RED="#E46A78"
COLOR_BORDER="#3C3C51"
COLOR_INACTIVE="#363644"

# Status bar configuration (zellij-inspired)
set -g status on
set -g status-interval 2
set -g status-position top
set -g status-justify left
set -g status-style "fg=#DDD8BB,bg=#1F1F28"

# Left status (session info)
set -g status-left-length 100
set -g status-left "#[fg=#DDD8BB,bg=#614A82,bold] #S #[fg=#614A82,bg=#1F1F28]"

# Right status (system info)
set -g status-right-length 100
set -g status-right "#[fg=#363644]#[fg=#DDD8BB,bg=#363644] %H:%M #[fg=#7EB3C9,bg=#363644]#[fg=#1F1F28,bg=#7EB3C9,bold] %d %b "

# Window status
set -g window-status-current-style "fg=#1F1F28,bg=#E5C283,bold"
set -g window-status-current-format " #I #W "
set -g window-status-style "fg=#DDD8BB,bg=#363644"
set -g window-status-format " #I #W "
set -g window-status-separator ""

# Pane borders (modern look)
set -g pane-border-style "fg=#3C3C51"
set -g pane-active-border-style "fg=#7EB3C9"

# Message styling
set -g message-style "fg=#1F1F28,bg=#E5C283"
set -g message-command-style "fg=#1F1F28,bg=#E5C283"

# Copy mode styling
set -g mode-style "fg=#1F1F28,bg=#E5C283"

# Clock color
set -g clock-mode-colour "#7EB3C9"